(function () {
	var this = $__this__;
	var stunt = $__this__.getBelongStunt();
	var situation = $__this__.getSituation();
	if (situation.isInStoryScene()) {
	
	} else {
		if (situation.isInitiative()) {
			var me = situation.getInitiativeBS();
			var targets = situation.getTargetsBS();
			var action = situation.getAction();
			var skillType = $.characterManager.getSkillType("Lore");
			$.campaignManager.askDM(me, "允许" + me.getName() + "使用" + stunt.getName() + "吗？", function(dmResult) {
				if (dmResult) {
					this.notifyResult(true, "");
					me.useSkill(skillType, action, targets, true, true, 2, null);
				} else {
					this.notifyResult(false, "DM拒绝你使用" + stunt.getName());
				}
			});
		} else {
			var initiative = situation.getInitiativeBS();
			var me = situation.getPassiveBS();
			var action = situation.getAction();
			var initiativeSkillType = situation.getInitiativeSkillType();
			var skillType = $.characterManager.getSkillType("Lore");
			$.campaignManager.askDM(me, "允许" + me.getName() + "使用" + stunt.getName() + "吗？", function(dmResult) {
				if (dmResult) {
					this.notifyResult(true, "");
					$.battleScene.currentPassiveUseSkill(skillType, true, 2, null);
				} else {
					this.notifyResult(false, "DM拒绝你使用" + stunt.getName());
				}
			});
		}
	}
})();
